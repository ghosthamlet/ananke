
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Causal Inference with Graphical Models &#8212; ananke-causal  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Structural Equation Models" href="linear_gaussian_sems.html" />
    <link rel="prev" title="Ananke: A module for causal inference" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Causal-Inference-with-Graphical-Models">
<h1>Causal Inference with Graphical Models<a class="headerlink" href="#Causal-Inference-with-Graphical-Models" title="Permalink to this headline">¶</a></h1>
<p>Broadly speaking, in causal inference, we are interested in using data from observational studies (as opposed to randomized control trials), in order to answer questions of the following form – What is the (causal) effect, on some outcome(s) <span class="math notranslate nohighlight">\(Y\)</span>, of setting (possibly contrary to fact) some variable(s) <span class="math notranslate nohighlight">\(A\)</span> to value(s) <span class="math notranslate nohighlight">\(a\)</span>, via an <strong>intervention</strong>. That is to say, causal inference concerns itself with the expression of counterfactual distributions obtained from observational
distributions through the process of interventions. Causal effects are sometimes determined using RCTs, but these are often expensive or unethical – think forcing a random portion of the population to smoke to determine the effect of smoking on lung cancer. The goal of causal inference then is to determine whether such causal effects can be teased out from purely observational data. When such counterfactual quantities can be written as functions of the observed data, they are said to be
<strong>identified</strong>. Not all causal effects can be identified, but many can – if we impose enough assumptions on the observed data distribution. Assumptions then, is the price we pay for identifiability, and so being transparent about our assumptions when making causal claims is paramount. This is where <strong>graphical models</strong> allow us to concisely, and intuitively state our set of assumptions. In the words of Miguel Hernán, “Graphical models allow us to draw our assumptions before our conclusions.”</p>
<p>A graph <span class="math notranslate nohighlight">\({\cal G}\)</span> is defined by a set of vertices <span class="math notranslate nohighlight">\({\bf V}\)</span> and edges that could be directed (e.g., <span class="math notranslate nohighlight">\(X \rightarrow\)</span> Y) interpreted as <span class="math notranslate nohighlight">\(X\)</span> being a direct cause of <span class="math notranslate nohighlight">\(Y\)</span>, bidirected (e.g., <span class="math notranslate nohighlight">\(X \leftrightarrow Y\)</span>) interpreted as the existence of unmeasured common causes of both <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> (<span class="math notranslate nohighlight">\(X \leftarrow {\bf U} \rightarrow Y\)</span>), or undirected (e.g., <span class="math notranslate nohighlight">\(X - Y\)</span>) interpreted as a symmetric relationship between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>. In Ananke,
we currently support acyclic graphical models i.e., we do not allow for cyclic causality. So how exactly do graphs help us encode assumptions? Consider the <strong>Directed Acyclic Graph (DAG)</strong> below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># imports for this notebook</span>

<span class="kn">from</span> <span class="nn">ananke</span> <span class="kn">import</span> <span class="n">graphs</span>
<span class="kn">from</span> <span class="nn">ananke</span> <span class="kn">import</span> <span class="n">identification</span>

<span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)]</span>
<span class="n">dag</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DAG</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="c1"># the direction LR is just to lay the vertices of the graph out from left to right</span>
<span class="c1"># instead of top to bottom which is the default</span>
<span class="n">dag</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_causal_graphs_1_0.svg" src="../_images/notebooks_causal_graphs_1_0.svg" /></div>
</div>
<p>All interventional distributions in causal models of a DAG are identified by application of the <a class="reference external" href="https://core.ac.uk/download/pdf/82537972.pdf">g-formula</a>. For example, <span class="math notranslate nohighlight">\(p(Y|{\rm do}(a))\)</span> written as <span class="math notranslate nohighlight">\(p(Y(a))\)</span> in potential outcomes notation which we will use more commonly here, is identified as</p>
<div class="math notranslate nohighlight">
\[p(Y(a))=\sum_{C, M}p(Y|M, C)p(M|A)p(C)|_{A=a}.\]</div>
<p>But as alluded to earlier, this comes at a price. The assumption made by a DAG (in addition to conditional independence constraints that can be read off by the graphical criterion of d-separation) is that of causal sufficiency, i.e., the absence of bidirected edges assumes the absence of unmeasured common causes. If we are unwilling to assume causal sufficiency, we can impose generalized independence constraints given by <a class="reference external" href="https://arxiv.org/pdf/1701.06686.pdf">Nested Markov models</a> of an
<strong>Acyclic Directed Mixed Graph (ADMG)</strong> representing marginals of DAG models. The ADMG corresponding to the scenario where <span class="math notranslate nohighlight">\(C\)</span> is unobserved is shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]</span>
<span class="n">di_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)]</span>
<span class="n">bi_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)]</span>
<span class="n">admg</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">ADMG</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">di_edges</span><span class="o">=</span><span class="n">di_edges</span><span class="p">,</span> <span class="n">bi_edges</span><span class="o">=</span><span class="n">bi_edges</span><span class="p">)</span>
<span class="n">admg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_causal_graphs_3_0.svg" src="../_images/notebooks_causal_graphs_3_0.svg" /></div>
</div>
<p>In this case <span class="math notranslate nohighlight">\(p(Y(a))\)</span> is still identified but not all interventional distributions of an ADMG are identified. A sound and complete algorithm for identification in ADMGs is known due to <a class="reference external" href="http://new.aaai.org/Papers/AAAI/2002/AAAI02-085.pdf">Tian and Pearl</a>, and <a class="reference external" href="https://ftp.cs.ucla.edu/pub/stat_ser/r327.pdf">Shpitser and Pearl</a>. In Ananke, we use a purely <a class="reference external" href="https://arxiv.org/pdf/1701.06686.pdf">graphical formulation</a> of the aforementioned works that uses the fixing operation
(<span class="math notranslate nohighlight">\(\phi\)</span>) on nested Markov models, in order to answer identification queries (example below). Note that some work is still required for Ananke to produce a simplified identifying functional in terms of the original data distribution <span class="math notranslate nohighlight">\(p({\bf V})\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">outcomes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
<span class="n">interventions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">id_pya</span> <span class="o">=</span> <span class="n">identification</span><span class="o">.</span><span class="n">OneLineID</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">admg</span><span class="p">,</span> <span class="n">interventions</span><span class="o">=</span><span class="n">interventions</span><span class="p">,</span> <span class="n">outcomes</span><span class="o">=</span><span class="n">outcomes</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Identifed =&#39;</span><span class="p">,</span> <span class="n">id_pya</span><span class="o">.</span><span class="n">id</span><span class="p">(),</span> <span class="s1">&#39;; Functional =&#39;</span><span class="p">,</span> <span class="n">id_pya</span><span class="o">.</span><span class="n">functional</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Identifed = True ; Functional = ΣM ΦAM(p(V);G) ΦAY(p(V);G)
</pre></div></div>
</div>
<p>Another implicit assumption made in the above examples was that our data consisted of independent and identically distributed (iid) samples. <strong>Chain Graphs (CGs)</strong>, consisting of directed and undirected edges such that there are no partially directed cycles, have emerged as a popular graphical model of <strong>interference</strong> (a violation of the independence assumption). Consider a scenario in which our population consists of dyads (say couples) capable of influencing each others outcomes. This may be
depicted as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">]</span>
<span class="n">di_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">)]</span>
<span class="n">ud_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">)]</span>
<span class="n">cg</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CG</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">di_edges</span><span class="o">=</span><span class="n">di_edges</span><span class="p">,</span> <span class="n">ud_edges</span><span class="o">=</span><span class="n">ud_edges</span><span class="p">)</span>
<span class="n">cg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_causal_graphs_7_0.svg" src="../_images/notebooks_causal_graphs_7_0.svg" /></div>
</div>
<p>All interventional distributions of a CG are identified by a <a class="reference external" href="https://www.jstor.org/stable/pdf/3088778.pdf?refreqid=excelsior%3A8042bfde904f401034faca7093a951c9">CG version</a> of the g-formula. Note however, that chain graphs assume causal sufficiency (lack of bidirected edges). If we’d like to further relax this assumption, we use <strong>Segregated Graphs (SGs)</strong>. Once again, if we do not observe <span class="math notranslate nohighlight">\(C\)</span>s in the CG shown above, we obtain the SG below. A sound and complete algorithm for
identification in SGs was provided by <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6330046/pdf/nihms-1001697.pdf">Sherman and Shpitser</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">]</span>
<span class="n">di_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">)]</span>
<span class="n">ud_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">)]</span>
<span class="n">bi_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">)]</span>
<span class="n">sg</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">SG</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">di_edges</span><span class="o">=</span><span class="n">di_edges</span><span class="p">,</span> <span class="n">ud_edges</span><span class="o">=</span><span class="n">ud_edges</span><span class="p">,</span> <span class="n">bi_edges</span><span class="o">=</span><span class="n">bi_edges</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_causal_graphs_9_0.svg" src="../_images/notebooks_causal_graphs_9_0.svg" /></div>
</div>
<p>We end this section by providing a hierarchy of graphical models (shown below). Two of the models in this hierarchy – bidirected graphs (BGs), and undirected graphs (UGs) are often not considered by themselves in causal analysis but are building blocks of more complicated graphical models that are, as reflected in the graph hierarchy. At the top of the hierarchy, are SGs comprised of directed, bidirected, and undirected edges. An SG with no undirected edges is an ADMG, and an SG with no
bidirected edges is a CG. A BG is an ADMG with no directed edges, and a UG is a CG with no directed edges. Finally, a DAG is an ADMG with no bidirected edges <em>or</em> alternatively a CG with no undirected edges. As we go further up in the hierarchy we relax more assumptions, but identification theory becomes trickier, and so does estimation. For example, a generalized likelihood for BGs, ADMGs, and SGs is not known.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># a graph of the hierarchy of graphs</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;ADMG&#39;</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;DAG&#39;</span><span class="p">,</span> <span class="s1">&#39;BG&#39;</span><span class="p">,</span> <span class="s1">&#39;UG&#39;</span><span class="p">]</span>
<span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;ADMG&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;ADMG&#39;</span><span class="p">,</span> <span class="s1">&#39;DAG&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;DAG&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;ADMG&#39;</span><span class="p">,</span> <span class="s1">&#39;BG&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;UG&#39;</span><span class="p">)]</span>
<span class="n">graphs</span><span class="o">.</span><span class="n">UG</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_causal_graphs_11_0.svg" src="../_images/notebooks_causal_graphs_11_0.svg" /></div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">ananke-causal</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Causal Inference with Graphical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_gaussian_sems.html">Structural Equation Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_gaussian_sems.html#Arid-Graphs">Arid Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_gaussian_sems.html#Fitting-and-Causal-Effect-Estimation">Fitting and Causal Effect Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_gaussian_sems.html#Model-Selection">Model Selection</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Ananke: A module for causal inference</a></li>
      <li>Next: <a href="linear_gaussian_sems.html" title="next chapter">Structural Equation Models</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Shpitser Lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/notebooks/causal_graphs.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>