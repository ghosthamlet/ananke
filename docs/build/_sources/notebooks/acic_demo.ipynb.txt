{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# imports for the demo\n",
    "from ananke.graphs import ADMG\n",
    "from ananke.identification import OneLineID\n",
    "from ananke.identification import NotIdentifiedError"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Back-Door\n",
    "\n",
    "Identification of $p(Y(a))$ in a DAG where the functional reduces to simple back-door adjustment."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.40.1 (20161225.0304)\n",
       " -->\n",
       "<!-- Title: %3 Pages: 1 -->\n",
       "<svg width=\"188pt\" height=\"67pt\"\n",
       " viewBox=\"0.00 0.00 188.00 67.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 63)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-63 184,-63 184,4 -4,4\"/>\n",
       "<!-- A -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>A</title>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-37.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">A</text>\n",
       "</g>\n",
       "<!-- Y -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>Y</title>\n",
       "<text text-anchor=\"middle\" x=\"162\" y=\"-14.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">Y</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;Y -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M108.1686,-35.1961C115.9537,-32.7092 125.2271,-29.7469 133.8653,-26.9875\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"135.126,-30.2591 143.5867,-23.882 132.9959,-23.591 135.126,-30.2591\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>C</title>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-14.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">C</text>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M36.1686,-23.8039C43.9537,-26.2908 53.2271,-29.2531 61.8653,-32.0125\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"60.9959,-35.409 71.5867,-35.118 63.126,-28.7409 60.9959,-35.409\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;Y -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>C&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M36.4756,-16.2918C46.8969,-15.4136 60.1632,-14.4378 72,-14 87.9891,-13.4086 92.0109,-13.4086 108,-14 116.2303,-14.3044 125.1517,-14.8689 133.3273,-15.4799\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"133.2781,-18.987 143.5244,-16.2918 133.8338,-12.009 133.2781,-18.987\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0xa1962a2e8>"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vertices = ['A', 'C', 'Y']\n",
    "di_edges = [('C', 'A'), ('C', 'Y'), ('A', 'Y')]\n",
    "backdoor_G = ADMG(vertices, di_edges=di_edges)\n",
    "backdoor_G.draw(direction='LR')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Identified = True ; Functional = ΣC ΦYA(p(V);G) ΦCA(p(V);G) \n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.40.1 (20161225.0304)\n",
       " -->\n",
       "<!-- Title: %3 Pages: 1 -->\n",
       "<svg width=\"260pt\" height=\"67pt\"\n",
       " viewBox=\"0.00 0.00 260.00 67.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 63)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-63 256,-63 256,4 -4,4\"/>\n",
       "<!-- A -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>A</title>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-37.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">A</text>\n",
       "</g>\n",
       "<!-- a -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>a</title>\n",
       "<polygon fill=\"none\" stroke=\"#000000\" points=\"180,-59 144,-59 144,-23 180,-23 180,-59\"/>\n",
       "<text text-anchor=\"middle\" x=\"162\" y=\"-37.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">a</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;a -->\n",
       "<!-- C -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>C</title>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-14.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">C</text>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M36.1686,-23.8039C43.9537,-26.2908 53.2271,-29.2531 61.8653,-32.0125\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"60.9959,-35.409 71.5867,-35.118 63.126,-28.7409 60.9959,-35.409\"/>\n",
       "</g>\n",
       "<!-- Y -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>Y</title>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-14.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">Y</text>\n",
       "</g>\n",
       "<!-- C&#45;&gt;Y -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>C&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M36.4756,-16.2918C46.8969,-15.4136 60.1632,-14.4378 72,-14 119.9672,-12.2259 132.0328,-12.2259 180,-14 188.2303,-14.3044 197.1517,-14.8689 205.3273,-15.4799\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"205.2781,-18.987 215.5244,-16.2918 205.8338,-12.009 205.2781,-18.987\"/>\n",
       "</g>\n",
       "<!-- a&#45;&gt;Y -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>a&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M180.1686,-35.1961C187.9537,-32.7092 197.2271,-29.7469 205.8653,-26.9875\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"207.126,-30.2591 215.5867,-23.882 204.9959,-23.591 207.126,-30.2591\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0xa196cda90>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "outcomes = ['Y']\n",
    "interventions = ['A']\n",
    "id_pya = OneLineID(graph=backdoor_G, interventions=interventions, outcomes=outcomes)\n",
    "print('Identified =', id_pya.id(), '; Functional =', id_pya.functional())\n",
    "id_pya.draw_swig(direction='LR')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Which reduces to the back-door functional: $\\sum_C p(Y|A, C)p(C)$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Front-Door\n",
    "\n",
    "Identification of $p(Y(a))$ in the front-door graph."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "vertices = ['A', 'M', 'Y']\n",
    "di_edges = [('A', 'M'), ('M', 'Y')]\n",
    "bi_edges = [('A', 'Y')]\n",
    "frontdoor_G = ADMG(vertices, di_edges=di_edges, bi_edges=bi_edges)\n",
    "frontdoor_G.draw(direction='LR')\n",
    "id_pya.export_intermediates('frontdoor')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Identified = True ; Functional = ΣM ΦAY(p(V);G) ΦAM(p(V);G) \n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.40.1 (20161225.0304)\n",
       " -->\n",
       "<!-- Title: %3 Pages: 1 -->\n",
       "<svg width=\"260pt\" height=\"67pt\"\n",
       " viewBox=\"0.00 0.00 260.00 67.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 63)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-63 256,-63 256,4 -4,4\"/>\n",
       "<!-- A -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>A</title>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-37.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">A</text>\n",
       "</g>\n",
       "<!-- Y -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>Y</title>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-37.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">Y</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;Y -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>A&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#ff0000\" d=\"M46.6727,-43.5201C54.8483,-44.1311 63.7697,-44.6956 72,-45 119.9672,-46.7741 132.0328,-46.7741 180,-45 188.2303,-44.6956 197.1517,-44.1311 205.3273,-43.5201\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"46.7219,-40.013 36.4756,-42.7082 46.1662,-46.991 46.7219,-40.013\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"205.8338,-46.991 215.5244,-42.7082 205.2781,-40.013 205.8338,-46.991\"/>\n",
       "</g>\n",
       "<!-- a -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>a</title>\n",
       "<polygon fill=\"none\" stroke=\"#000000\" points=\"108,-36 72,-36 72,0 108,0 108,-36\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-14.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">a</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;a -->\n",
       "<!-- M -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>M</title>\n",
       "<text text-anchor=\"middle\" x=\"162\" y=\"-14.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">M</text>\n",
       "</g>\n",
       "<!-- M&#45;&gt;Y -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>M&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M180.1686,-23.8039C187.9537,-26.2908 197.2271,-29.2531 205.8653,-32.0125\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"204.9959,-35.409 215.5867,-35.118 207.126,-28.7409 204.9959,-35.409\"/>\n",
       "</g>\n",
       "<!-- a&#45;&gt;M -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>a&#45;&gt;M</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M108.1686,-18C115.869,-18 125.0257,-18 133.5834,-18\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"133.5868,-21.5001 143.5867,-18 133.5867,-14.5001 133.5868,-21.5001\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0xa196e9c18>"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "outcomes = ['Y']\n",
    "interventions = ['A']\n",
    "id_pya = OneLineID(graph=frontdoor_G, interventions=interventions, outcomes=outcomes)\n",
    "print('Identified =', id_pya.id(), '; Functional =', id_pya.functional())\n",
    "id_pya.draw_swig(direction='LR')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Which reduces to the front-door functional: $\\sum_M \\big( \\sum_{A'} p(Y|M, A')p(A') \\big) p(M|A)$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# A more complicated example\n",
    "\n",
    "Identification of $p(Y(a))$ in a more complicated graph."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Identified = True ; Functional = ΣBCD ΦAC(p(V);G) ΦABDY(p(V);G) \n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.40.1 (20161225.0304)\n",
       " -->\n",
       "<!-- Title: %3 Pages: 1 -->\n",
       "<svg width=\"260pt\" height=\"136pt\"\n",
       " viewBox=\"0.00 0.00 260.00 136.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 132)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-132 256,-132 256,4 -4,4\"/>\n",
       "<!-- A -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>A</title>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-60.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">A</text>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>B</title>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-60.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M36.1686,-64C43.869,-64 53.0257,-64 61.5834,-64\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"61.5868,-67.5001 71.5867,-64 61.5867,-60.5001 61.5868,-67.5001\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>C</title>\n",
       "<text text-anchor=\"middle\" x=\"162\" y=\"-106.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">C</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;C -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>A&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"#ff0000\" d=\"M45.4095,-79.4002C53.7559,-83.622 63.0844,-87.8878 72,-91 92.1657,-98.0394 115.8267,-102.9095 133.8262,-105.9556\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"46.9594,-76.2609 36.4778,-74.716 43.7083,-82.4601 46.9594,-76.2609\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"133.2721,-109.4114 143.7005,-107.5409 134.3818,-102.4999 133.2721,-109.4114\"/>\n",
       "</g>\n",
       "<!-- D -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>D</title>\n",
       "<text text-anchor=\"middle\" x=\"162\" y=\"-14.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">D</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;D -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>A&#45;&gt;D</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M36.4778,-53.284C46.6761,-47.7521 59.729,-41.2835 72,-37 92.1657,-29.9606 115.8267,-25.0905 133.8262,-22.0444\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"134.3818,-25.5001 143.7005,-20.4591 133.2721,-18.5886 134.3818,-25.5001\"/>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M108.1686,-75.6077C116.2921,-80.7978 126.0363,-87.0232 134.9882,-92.7425\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"133.2754,-95.8015 143.5867,-98.236 137.0441,-89.9026 133.2754,-95.8015\"/>\n",
       "</g>\n",
       "<!-- B&#45;&gt;D -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>B&#45;&gt;D</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M108.1686,-46.4399C116.2075,-40.5205 125.8334,-34.1643 134.7082,-28.8651\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"136.6433,-31.7905 143.5867,-23.788 133.1684,-25.7138 136.6433,-31.7905\"/>\n",
       "</g>\n",
       "<!-- B&#45;&gt;D -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;D</title>\n",
       "<path fill=\"none\" stroke=\"#ff0000\" d=\"M117.0225,-53.2955C122.9749,-49.7496 129.277,-45.7197 135.2197,-41.6589\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"115.1215,-50.3504 108.1686,-58.3447 118.5893,-56.4311 115.1215,-50.3504\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"137.4442,-44.3725 143.5867,-35.74 133.4016,-38.6579 137.4442,-44.3725\"/>\n",
       "</g>\n",
       "<!-- Y -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>Y</title>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-60.3\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">Y</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;Y -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>B&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#ff0000\" d=\"M118.5287,-64C143.8633,-64 180.6754,-64 205.8843,-64\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"118.2377,-60.5001 108.2377,-64 118.2377,-67.5001 118.2377,-60.5001\"/>\n",
       "<polygon fill=\"#ff0000\" stroke=\"#ff0000\" points=\"205.9104,-67.5001 215.9104,-64 205.9103,-60.5001 205.9104,-67.5001\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;Y -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>C&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M180.1686,-98.3923C188.2921,-93.2022 198.0363,-86.9768 206.9882,-81.2575\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"209.0441,-84.0974 215.5867,-75.764 205.2754,-78.1985 209.0441,-84.0974\"/>\n",
       "</g>\n",
       "<!-- D&#45;&gt;Y -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>D&#45;&gt;Y</title>\n",
       "<path fill=\"none\" stroke=\"#0000ff\" d=\"M180.1686,-29.6077C188.2921,-34.7978 198.0363,-41.0232 206.9882,-46.7425\"/>\n",
       "<polygon fill=\"#0000ff\" stroke=\"#0000ff\" points=\"205.2754,-49.8015 215.5867,-52.236 209.0441,-43.9026 205.2754,-49.8015\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0xa196cd438>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vertices = ['A', 'B', 'C', 'D', 'Y']\n",
    "di_edges = [('A', 'B'), ('A', 'D'), ('B', 'C'), ('C', 'Y'), ('B', 'D'), ('D', 'Y')]\n",
    "bi_edges = [('A', 'C'), ('B', 'Y'), ('B', 'D')]\n",
    "G = ADMG(vertices, di_edges, bi_edges)\n",
    "id_pya = OneLineID(graph=G, interventions=['A'], outcomes=['Y'])\n",
    "print('Identified =', id_pya.id(), '; Functional =', id_pya.functional())\n",
    "id_pya.export_intermediates()\n",
    "G.draw(direction='LR')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Try identifying $p(Y(a, b))$ in the same graph and notice that it fails"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Not Identified\n"
     ]
    }
   ],
   "source": [
    "id_pyab = OneLineID(graph=G, interventions=['A', 'B'], outcomes=['Y'])\n",
    "try:\n",
    "    print('Identified =', id_pyab.id(), '; Functional =', id_pyab.functional())\n",
    "except NotIdentifiedError:\n",
    "    print('Not Identified')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
